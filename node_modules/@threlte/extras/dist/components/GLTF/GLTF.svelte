<script>import { createRawEventDispatcher, forwardEventHandlers, T } from '@threlte/core';
import { useGltf } from '../../hooks/useGltf';
const component = forwardEventHandlers();
export let url;
export let useDraco = false;
export let useMeshopt = false;
export let ktxTranscoderPath = undefined;
const dispatch = createRawEventDispatcher();
export let gltf = undefined;
export let scene = undefined;
export let animations = undefined;
export let asset = undefined;
export let cameras = undefined;
export let scenes = undefined;
export let userData = undefined;
export let parser = undefined;
export let materials = undefined;
export let nodes = undefined;
const loader = useGltf({
    useDraco: useDraco
        ? typeof useDraco === 'string'
            ? useDraco
            : 'https://www.gstatic.com/draco/v1/decoders/'
        : undefined,
    useMeshopt,
    ktxTranscoderPath
});
const onLoad = (data) => {
    if (gltf)
        dispatch('unload');
    gltf = data;
    scene = data.scene;
    animations = data.animations;
    asset = data.asset;
    cameras = data.cameras;
    scenes = data.scenes;
    userData = data.userData;
    parser = data.parser;
    materials = data.materials;
    nodes = data.nodes;
    dispatch('load', gltf);
};
const onError = (error) => {
    console.error(`Error loading GLTF: ${error.message}`);
    gltf = undefined;
    scene = undefined;
    animations = undefined;
    asset = undefined;
    cameras = undefined;
    scenes = undefined;
    userData = undefined;
    parser = undefined;
    nodes = undefined;
    materials = undefined;
    dispatch('error', error.message);
};
const loadGltf = async (url) => {
    try {
        const model = await loader.load(url);
        onLoad(model);
    }
    catch (error) {
        onError(error);
    }
};
$: loadGltf(url);
</script>

{#if scene}
  <T is={scene} {...$$restProps} let:ref bind:this={$component}>
    <slot {ref} />
  </T>
{/if}
